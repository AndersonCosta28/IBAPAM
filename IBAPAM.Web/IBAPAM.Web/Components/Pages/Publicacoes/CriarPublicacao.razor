@page "/publicacoes/criar-publicacao"
@using IBAPAM.Shared.Models.PublicacaoDTOs
@using IBAPAM.Web.Client.Components
@using IBAPAM.Web.Client.Interfaces
@inject IPublicacaoService PublicacaoService
@inject NavigationManager Navigation
@rendermode InteractiveAuto
<RadzenStack Style="padding: 20px">
    <RadzenText TextStyle="TextStyle.H3">Criar publicação</RadzenText>

    <RadzenTemplateForm Submit="criar" TItem="PublicacaoUpdateDto">
        <RadzenStack Gap="20px">
            <RadzenRow>
                <RadzenFormField Text="Título" Variant="Radzen.Variant.Outlined">
                    <ChildContent>
                        <RadzenTextBox Name="Titulo" @bind-Value=@this._publicacaoDto.Titulo />
                    </ChildContent>
                </RadzenFormField>
            </RadzenRow>
            <RadzenRow>
                <RadzenFormField Text="Conteúdo" Variant="Radzen.Variant.Outlined">
                    <RadzenHTMLEditorComponent Value="@this._publicacaoDto.Conteudo"
                                               ValueChanged="v=> this._publicacaoDto.Conteudo =v" />
                </RadzenFormField>
            </RadzenRow>
            <RadzenRow>
                <RadzenButton ButtonType="Radzen.ButtonType.Button" Click="PublicacaoService.NavegarParaTelaDeListagem">Cancelar</RadzenButton>
                <RadzenButton ButtonType="Radzen.ButtonType.Submit">Criar</RadzenButton>
            </RadzenRow>
        </RadzenStack>
    </RadzenTemplateForm>
</RadzenStack>

@code {
    private PublicacaoCreateDto _publicacaoDto = new PublicacaoCreateDto();

    private async Task criar()
    {
        await PublicacaoService.CreateAsync(_publicacaoDto);

        PublicacaoService.NavegarParaTelaDeListagem();
    }
}